# üìö Syst√®me de Questions Pr√©-d√©finies & Authentification √âtudiants

## ‚úÖ Changements Majeurs Impl√©ment√©s

### 1. **Questions Pr√©-d√©finies** (Plus de g√©n√©ration OpenAI)
- ‚úÖ 10 questions PRE-inscription (niveau d√©butant)
- ‚úÖ 10 questions POST-masterclass (validation des acquis)
- ‚úÖ Questions stock√©es en base de donn√©es
- ‚úÖ Pas besoin d'OpenAI pour g√©n√©rer les questions

### 2. **Syst√®me d'Authentification √âtudiants**
- ‚úÖ Connexion par email uniquement
- ‚úÖ Token de session (valide 24h)
- ‚úÖ Dashboard personnel pour chaque √©tudiant

### 3. **Gestion des Tests PRE/POST**
- ‚úÖ Test PRE : Disponible imm√©diatement apr√®s inscription
- ‚úÖ Test POST : Disponible UNIQUEMENT apr√®s la date de la masterclass
- ‚úÖ Historique complet des tests dans le dashboard

---

## üéØ Nouveau Flux Complet

```
1. Inscription
   ‚îî‚îÄ> Formulaire + Validation

2. S√©lection de Session
   ‚îî‚îÄ> Choix de la date (12 dates disponibles)

3. Test PRE-Inscription
   ‚îî‚îÄ> 10 questions faciles (niveau d√©butant)
   ‚îî‚îÄ> Score enregistr√©

4. Connexion Espace √âtudiant
   ‚îî‚îÄ> Email uniquement
   ‚îî‚îÄ> Dashboard personnel

5. Masterclass (Date s√©lectionn√©e)
   ‚îî‚îÄ> Participation √† la masterclass

6. Test POST-Masterclass (Apr√®s la date)
   ‚îî‚îÄ> 10 questions (validation des acquis)
   ‚îî‚îÄ> Score enregistr√©
```

---

## üìù Questions Pr√©-d√©finies

### Test PRE-Inscription (10 questions)

**Objectif** : √âvaluer les connaissances de base en IA avant la formation

1. Qu'est-ce que l'intelligence artificielle ?
   - A) Une science magique
   - B) Un robot uniquement
   - **C) Une technologie qui imite certaines capacit√©s humaines** ‚úì
   - D) Une nouvelle langue

2. L'IA est-elle d√©j√† pr√©sente dans notre vie quotidienne ?
   - A) Non, c'est trop r√©cent
   - **B) Oui, mais on ne s'en rend pas toujours compte** ‚úì
   - C) Uniquement dans les films
   - D) Seulement dans les labos

3. Quel outil est un exemple d'IA g√©n√©rative ?
   - A) Word
   - **B) ChatGPT** ‚úì
   - C) Excel
   - D) PowerPoint

4. Lequel de ces secteurs n'utilise pas l'IA ?
   - A) Sant√©
   - B) Agriculture
   - **C) Cuisine traditionnelle manuelle** ‚úì
   - D) Finance

5. √Ä quoi sert un prompt ?
   - A) Mise √† jour
   - **B) Question/commande √† l'IA** ‚úì
   - C) Logiciel
   - D) Image

6. Une IA peut-elle produire un texte ?
   - A) Non
   - **B) Oui, si bien entra√Æn√©e** ‚úì
   - C) Uniquement des images
   - D) Jamais sans humain

7. Quelle IA est de Google ?
   - **A) Gemini** ‚úì
   - B) ChatGPT
   - C) Copilot
   - D) Bard

8. L'IA peut-elle avoir des biais ?
   - A) Non
   - **B) Oui, √† cause des donn√©es** ‚úì
   - C) Rarement
   - D) Seulement en maths

9. Quel outil permet de cr√©er des visuels ?
   - **A) Canva** ‚úì
   - B) Perplexity
   - C) Word
   - D) Google Docs

10. Que signifie "IA g√©n√©rative" ?
    - A) IA qui comprend les √©motions
    - **B) IA qui g√©n√®re du contenu** ‚úì
    - C) IA pour l'√©lectricit√©
    - D) IA militaire

---

### Test POST-Masterclass (10 questions)

**Objectif** : Valider la compr√©hension des concepts, outils et √©thique apr√®s la masterclass

1. Structure d'un bon prompt ?
   - A) Objectif ‚Äì Format ‚Äì R√¥le
   - **B) Contexte ‚Äì R√¥le ‚Äì Objectif ‚Äì Format ‚Äì Ton ‚Äì Contraintes** ‚úì
   - C) Sujet ‚Äì Verbe ‚Äì Compl√©ment
   - D) Titre ‚Äì Image ‚Äì R√©sum√©

2. R√®gle d'or N¬∞1 du prompt ?
   - A) √âcrire vite
   - B) √ätre flou
   - **C) Donner du contexte** ‚úì
   - D) Copier-coller

3. Outil acad√©mique IA ?
   - A) Canva
   - **B) ChatGPT / Perplexity** ‚úì
   - C) Google Maps
   - D) PowerPoint

4. Activit√© de l'atelier pratique ?
   - A) Lecture
   - **B) Prompt Battle** ‚úì
   - C) Jeu de soci√©t√©
   - D) Cr√©ation PDF

5. Pourquoi IA peut √™tre biais√©e ?
   - A) Toujours exacte
   - **B) Donn√©es d'entra√Ænement** ‚úì
   - C) Ne dort pas
   - D) Pas d'Internet

6. Outil IA pour cr√©er un CV ?
   - A) ChatGPT
   - **B) Canva** ‚úì
   - C) Excel
   - D) Perplexity

7. R√¥le de l'√©thique en IA ?
   - A) Aucun
   - B) Performance
   - **C) Usage responsable** ‚úì
   - D) Cr√©er des lois

8. IA remplacera-t-elle les humains ?
   - A) Oui
   - **B) Non, elle les rendra meilleurs** ‚úì
   - C) En cuisine
   - D) Dans 1000 ans

9. Objectif du mini-projet ?
   - A) Cr√©er une app IA
   - **B) Id√©e d'usage local** ‚úì
   - C) Noter les autres groupes
   - D) Refaire le cours

10. Nom de l'IA de Microsoft ?
    - A) Gemini
    - B) Bard
    - **C) Copilot** ‚úì
    - D) Watson

---

## üîê Syst√®me d'Authentification

### Connexion √âtudiant

**URL** : `/student/login`

**Fonctionnement** :
1. L'√©tudiant entre son email d'inscription
2. Le syst√®me v√©rifie l'existence du compte
3. Un token de session est g√©n√©r√© (valide 24h)
4. L'√©tudiant est redirig√© vers son dashboard

**S√©curit√©** :
- Token unique par session
- Expiration automatique apr√®s 24h
- V√©rification √† chaque requ√™te

---

## üìä Dashboard √âtudiant

**URL** : `/student/dashboard`

### Informations Affich√©es

#### 1. Informations Personnelles
- Nom complet
- Email
- Date d'inscription

#### 2. Session de Masterclass
- Date s√©lectionn√©e
- Heure de la session
- Statut (√† venir / pass√©e)

#### 3. Test PRE-Inscription
- ‚úÖ Score obtenu (X/10)
- ‚úÖ Date de passage
- ‚úÖ Lien vers les r√©sultats d√©taill√©s

#### 4. Test POST-Masterclass
- üîí **AVANT la masterclass** : "Test non disponible"
- ‚úÖ **APR√àS la masterclass** : "Test disponible" + Bouton
- ‚úÖ **D√©j√† pass√©** : Score + R√©sultats

---

## üóÑÔ∏è Structure de la Base de Donn√©es

### Nouvelles Tables

#### `student_auth_tokens`
```sql
CREATE TABLE student_auth_tokens (
  id UUID PRIMARY KEY,
  profile_id UUID REFERENCES profiles(id),
  token VARCHAR(255) UNIQUE,
  expires_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ,
  last_used_at TIMESTAMPTZ
);
```

#### Colonne ajout√©e : `questions.test_type`
```sql
ALTER TABLE questions 
ADD COLUMN test_type VARCHAR(10) DEFAULT 'PRE' 
CHECK (test_type IN ('PRE', 'POST'));
```

#### Vue : `student_dashboard`
```sql
CREATE VIEW student_dashboard AS
SELECT 
  p.id as profile_id,
  p.full_name,
  p.email,
  i.id as inscription_id,
  ms.session_date,
  ms.session_time,
  -- Test PRE
  pre_test.id as pre_test_id,
  pre_test.score as pre_test_score,
  -- Test POST
  post_test.id as post_test_id,
  post_test.score as post_test_score,
  -- Disponibilit√©
  CASE 
    WHEN ms.session_date <= CURRENT_DATE THEN TRUE
    ELSE FALSE
  END as post_test_available
FROM profiles p
LEFT JOIN inscriptions i ON p.id = i.profile_id
LEFT JOIN session_bookings sb ON i.id = sb.inscription_id
LEFT JOIN masterclass_sessions ms ON sb.session_id = ms.id
LEFT JOIN tests pre_test ON i.id = pre_test.inscription_id AND pre_test.type = 'PRE'
LEFT JOIN tests post_test ON i.id = post_test.inscription_id AND post_test.type = 'POST';
```

---

## üîß APIs Cr√©√©es

### 1. Authentification

#### `POST /api/student/auth/login`
```json
{
  "email": "etudiant@example.com"
}
```

**R√©ponse** :
```json
{
  "success": true,
  "token": "abc123...",
  "profile": {
    "id": "uuid",
    "name": "Jean Dupont",
    "email": "etudiant@example.com"
  }
}
```

#### `POST /api/student/auth/verify`
```json
{
  "token": "abc123..."
}
```

**R√©ponse** :
```json
{
  "success": true,
  "profile": { ... }
}
```

### 2. Dashboard

#### `GET /api/student/dashboard`
**Headers** : `Authorization: Bearer <token>`

**R√©ponse** :
```json
{
  "success": true,
  "data": {
    "full_name": "Jean Dupont",
    "email": "jean@example.com",
    "session_date": "2025-10-20",
    "session_time": "14:00-17:00",
    "pre_test_score": 8,
    "pre_test_max_score": 10,
    "post_test_available": true,
    "post_test_score": null
  }
}
```

### 3. Questions

#### `GET /api/questions?masterclass_id=<id>&test_type=PRE`
**R√©ponse** :
```json
{
  "questions": [
    {
      "id": "uuid",
      "question_text": "Qu'est-ce que l'IA ?",
      "choices": {
        "A": "...",
        "B": "...",
        "C": "...",
        "D": "..."
      },
      "test_type": "PRE"
    }
  ]
}
```

### 4. Disponibilit√© Test POST

#### `GET /api/test/post/availability`
**Headers** : `Authorization: Bearer <token>`

**R√©ponse** :
```json
{
  "success": true,
  "available": true,
  "session_date": "2025-10-20",
  "already_taken": false,
  "message": "Test POST disponible"
}
```

---

## üì± Pages Cr√©√©es/Modifi√©es

### Nouvelles Pages

1. **`/student/login`** - Connexion √©tudiant
2. **`/student/dashboard`** - Dashboard personnel
3. **`/inscription/session/[id]`** - S√©lection de session apr√®s inscription

### Pages Modifi√©es

1. **`/test/pre`** - Utilise questions PRE pr√©-d√©finies
2. **`/test/post`** - Utilise questions POST pr√©-d√©finies
3. **`/test/results/[id]`** - Suppression du s√©lecteur de session

---

## üöÄ Installation & D√©ploiement

### √âtape 1 : Appliquer la Migration SQL

```bash
# 1. Ouvrir Supabase SQL Editor
https://apqpsyugdmvrzaprugvw.supabase.co/project/apqpsyugdmvrzaprugvw/sql/new

# 2. Copier le contenu de :
supabase/migrations/005_predefined_questions_and_auth.sql

# 3. Coller et cliquer "Run"
```

**Cette migration va** :
- ‚úÖ Supprimer les anciennes questions
- ‚úÖ Ins√©rer 10 questions PRE
- ‚úÖ Ins√©rer 10 questions POST
- ‚úÖ Cr√©er la table `student_auth_tokens`
- ‚úÖ Cr√©er la vue `student_dashboard`
- ‚úÖ Ajouter la colonne `test_type` √† `questions`

### √âtape 2 : Red√©marrer l'Application

```bash
# Si l'app tourne d√©j√†, hot reload automatique
# Sinon :
npm run dev
```

---

## üß™ Tester le Syst√®me

### 1. Test d'Inscription Compl√®te

```bash
1. Aller sur /inscription
2. Remplir le formulaire
3. Choisir une date de masterclass
4. Passer le test PRE (10 questions faciles)
5. Voir les r√©sultats
```

### 2. Test de Connexion √âtudiant

```bash
1. Aller sur /student/login
2. Entrer l'email d'inscription
3. ‚úÖ Voir le dashboard personnel
4. ‚úÖ Voir le score du test PRE
5. ‚úÖ Voir la date de la masterclass
```

### 3. Test de Disponibilit√© POST

```bash
# Cas 1 : AVANT la masterclass
- Le test POST est gris√©
- Message : "Test disponible apr√®s votre masterclass"

# Cas 2 : APR√àS la masterclass
- Le test POST est disponible
- Bouton : "Passer le test post-masterclass"

# Cas 3 : D√©j√† pass√©
- Score affich√©
- Lien vers les r√©sultats
```

---

## üìä Logique de Disponibilit√© du Test POST

```sql
-- Le test POST est disponible SI :
1. La date de la masterclass est pass√©e (session_date <= CURRENT_DATE)
2. ET le test n'a pas encore √©t√© pass√© (post_test_id IS NULL)

-- Impl√©ment√© dans la vue student_dashboard :
CASE 
  WHEN ms.session_date IS NOT NULL 
   AND ms.session_date <= CURRENT_DATE THEN TRUE
  ELSE FALSE
END as post_test_available
```

---

## üé® Interface Utilisateur

### Dashboard √âtudiant

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Espace √âtudiant                    ‚îÇ
‚îÇ  Jean Dupont                        ‚îÇ
‚îÇ                          [D√©connexion]
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìÖ Ma Masterclass                  ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ  Date : 20 octobre 2025             ‚îÇ
‚îÇ  Heure : 14:00-17:00                ‚îÇ
‚îÇ  üìç D√©tails par WhatsApp            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚úÖ Test Pr√©-Inscription            ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ  Score : 8/10                       ‚îÇ
‚îÇ  Pass√© le : 15 octobre 2025         ‚îÇ
‚îÇ  [Voir les r√©sultats d√©taill√©s]    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üèÜ Test Post-Masterclass           ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ  ‚úÖ Test disponible !               ‚îÇ
‚îÇ  Votre masterclass a eu lieu.       ‚îÇ
‚îÇ  [Passer le test post-masterclass]  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚úÖ Avantages du Nouveau Syst√®me

### 1. **Simplicit√©**
- ‚úÖ Pas besoin d'OpenAI pour g√©n√©rer les questions
- ‚úÖ Questions coh√©rentes pour tous les √©tudiants
- ‚úÖ Co√ªts r√©duits (pas d'API calls)

### 2. **Contr√¥le**
- ‚úÖ Questions valid√©es et test√©es
- ‚úÖ Difficult√© ma√Ætris√©e
- ‚úÖ Progression p√©dagogique claire

### 3. **Exp√©rience Utilisateur**
- ‚úÖ Dashboard personnel pour chaque √©tudiant
- ‚úÖ Historique complet des tests
- ‚úÖ Disponibilit√© automatique du test POST

### 4. **S√©curit√©**
- ‚úÖ Authentification par token
- ‚úÖ Expiration automatique
- ‚úÖ Acc√®s contr√¥l√© aux donn√©es

---

## üìà M√©triques Disponibles

### Pour les Administrateurs

```sql
-- Nombre d'√©tudiants inscrits
SELECT COUNT(*) FROM profiles;

-- Scores moyens PRE
SELECT AVG(score) FROM tests WHERE type = 'PRE';

-- Scores moyens POST
SELECT AVG(score) FROM tests WHERE type = 'POST';

-- Progression moyenne
SELECT 
  AVG(post.score - pre.score) as progression
FROM tests pre
JOIN tests post ON pre.inscription_id = post.inscription_id
WHERE pre.type = 'PRE' AND post.type = 'POST';

-- Sessions les plus populaires
SELECT session_date, COUNT(*) as bookings
FROM session_bookings sb
JOIN masterclass_sessions ms ON sb.session_id = ms.id
GROUP BY session_date
ORDER BY bookings DESC;
```

---

## üéØ R√©sum√© des Fichiers

### Migrations SQL
- ‚úÖ `005_predefined_questions_and_auth.sql` - Questions + Auth

### APIs
- ‚úÖ `/api/student/auth/login/route.ts` - Connexion
- ‚úÖ `/api/student/auth/verify/route.ts` - V√©rification token
- ‚úÖ `/api/student/dashboard/route.ts` - Dashboard
- ‚úÖ `/api/test/post/availability/route.ts` - Disponibilit√© POST
- ‚úÖ `/api/questions/route.ts` - Questions (modifi√© pour filtrer PRE/POST)

### Pages
- ‚úÖ `/student/login/page.tsx` - Connexion
- ‚úÖ `/student/dashboard/page.tsx` - Dashboard
- ‚úÖ `/inscription/session/[id]/page.tsx` - S√©lection session
- ‚úÖ `/test/pre/page.tsx` - Test PRE (modifi√©)
- ‚úÖ `/test/post/page.tsx` - Test POST (modifi√©)

---

## üéâ Syst√®me Complet et Fonctionnel !

**Le syst√®me est maintenant :**
- ‚úÖ Autonome (pas besoin d'OpenAI)
- ‚úÖ S√©curis√© (authentification par token)
- ‚úÖ Intelligent (test POST disponible apr√®s masterclass)
- ‚úÖ User-friendly (dashboard personnel)
- ‚úÖ √âvolutif (facile d'ajouter de nouvelles questions)

**Prochaines √©tapes :**
1. Appliquer la migration SQL
2. Tester le flux complet
3. V√©rifier la disponibilit√© du test POST
4. Personnaliser les emails de connexion (optionnel)
